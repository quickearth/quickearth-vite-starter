define(["exports","./Transforms-b2c3e401","./Cartesian2-e9bb1bb3","./Check-5e798bbf","./when-208fe5b0","./EllipsoidTangentPlane-f517eeed","./Math-56f06cd5","./Plane-6fbc10a1"],function(e,O,E,g,P,b,y,N){"use strict";function v(e,a){this.center=E.Cartesian3.clone(P.defaultValue(e,E.Cartesian3.ZERO)),this.halfAxes=O.Matrix3.clone(P.defaultValue(a,O.Matrix3.ZERO))}v.packedLength=E.Cartesian3.packedLength+O.Matrix3.packedLength,v.pack=function(e,a,t){return g.Check.typeOf.object("value",e),g.Check.defined("array",a),t=P.defaultValue(t,0),E.Cartesian3.pack(e.center,a,t),O.Matrix3.pack(e.halfAxes,a,t+E.Cartesian3.packedLength),a},v.unpack=function(e,a,t){return g.Check.defined("array",e),a=P.defaultValue(a,0),P.defined(t)||(t=new v),E.Cartesian3.unpack(e,a,t.center),O.Matrix3.unpack(e,a+E.Cartesian3.packedLength,t.halfAxes),t};var A=new E.Cartesian3,T=new E.Cartesian3,R=new E.Cartesian3,I=new E.Cartesian3,D=new E.Cartesian3,L=new E.Cartesian3,z=new O.Matrix3,S={unitary:new O.Matrix3,diagonal:new O.Matrix3};v.fromPoints=function(e,a){if(P.defined(a)||(a=new v),!P.defined(e)||0===e.length)return a.halfAxes=O.Matrix3.ZERO,a.center=E.Cartesian3.ZERO,a;for(var t=e.length,r=E.Cartesian3.clone(e[0],A),n=1;n<t;n++)E.Cartesian3.add(r,e[n],r);var i=1/t;E.Cartesian3.multiplyByScalar(r,i,r);var s,o=0,d=0,C=0,u=0,c=0,l=0;for(n=0;n<t;n++)o+=(s=E.Cartesian3.subtract(e[n],r,T)).x*s.x,d+=s.x*s.y,C+=s.x*s.z,u+=s.y*s.y,c+=s.y*s.z,l+=s.z*s.z;d*=i,C*=i,u*=i,c*=i,l*=i;var h=z;h[0]=o*=i,h[1]=d,h[2]=C,h[3]=d,h[4]=u,h[5]=c,h[6]=C,h[7]=c,h[8]=l;var h=O.Matrix3.computeEigenDecomposition(h,S),h=O.Matrix3.clone(h.unitary,a.halfAxes),f=O.Matrix3.getColumn(h,0,I),m=O.Matrix3.getColumn(h,1,D),x=O.Matrix3.getColumn(h,2,L),p=-Number.MAX_VALUE,M=-Number.MAX_VALUE,w=-Number.MAX_VALUE,g=Number.MAX_VALUE,b=Number.MAX_VALUE,y=Number.MAX_VALUE;for(n=0;n<t;n++)s=e[n],p=Math.max(E.Cartesian3.dot(f,s),p),M=Math.max(E.Cartesian3.dot(m,s),M),w=Math.max(E.Cartesian3.dot(x,s),w),g=Math.min(E.Cartesian3.dot(f,s),g),b=Math.min(E.Cartesian3.dot(m,s),b),y=Math.min(E.Cartesian3.dot(x,s),y);f=E.Cartesian3.multiplyByScalar(f,.5*(g+p),f),m=E.Cartesian3.multiplyByScalar(m,.5*(b+M),m),x=E.Cartesian3.multiplyByScalar(x,.5*(y+w),x),h=E.Cartesian3.add(f,m,a.center);E.Cartesian3.add(h,x,h);h=R;return h.x=p-g,h.y=M-b,h.z=w-y,E.Cartesian3.multiplyByScalar(h,.5,h),O.Matrix3.multiplyByScale(a.halfAxes,h,a.halfAxes),a};var l=new E.Cartesian3,h=new E.Cartesian3;function q(e,a,t,r,n,i,s,o,d,C,u){if(!(P.defined(n)&&P.defined(i)&&P.defined(s)&&P.defined(o)&&P.defined(d)&&P.defined(C)))throw new g.DeveloperError("all extents (minimum/maximum X/Y/Z) are required.");var c=(u=!P.defined(u)?new v:u).halfAxes;O.Matrix3.setColumn(c,0,a,c),O.Matrix3.setColumn(c,1,t,c),O.Matrix3.setColumn(c,2,r,c),(t=l).x=(n+i)/2,t.y=(s+o)/2,t.z=(d+C)/2;r=h;r.x=(i-n)/2,r.y=(o-s)/2,r.z=(C-d)/2;d=u.center,t=O.Matrix3.multiplyByVector(c,t,t);return E.Cartesian3.add(e,t,d),O.Matrix3.multiplyByScale(c,r,c),u}var U=new E.Cartographic,V=new E.Cartesian3,k=new E.Cartographic,B=new E.Cartographic,_=new E.Cartographic,W=new E.Cartographic,X=new E.Cartographic,j=new E.Cartesian3,Z=new E.Cartesian3,G=new E.Cartesian3,Y=new E.Cartesian3,F=new E.Cartesian3,H=new E.Cartesian2,J=new E.Cartesian2,K=new E.Cartesian2,Q=new E.Cartesian2,$=new E.Cartesian2,ee=new E.Cartesian3,ae=new E.Cartesian3,te=new E.Cartesian3,re=new E.Cartesian3,ne=new E.Cartesian2,ie=new E.Cartesian3,se=new E.Cartesian3,oe=new E.Cartesian3,de=new N.Plane(E.Cartesian3.UNIT_X,0);v.fromRectangle=function(e,a,t,r,n){if(!P.defined(e))throw new g.DeveloperError("rectangle is required");if(e.width<0||e.width>y.CesiumMath.TWO_PI)throw new g.DeveloperError("Rectangle width must be between 0 and 2*pi");if(e.height<0||e.height>y.CesiumMath.PI)throw new g.DeveloperError("Rectangle height must be between 0 and pi");if(P.defined(r)&&!y.CesiumMath.equalsEpsilon(r.radii.x,r.radii.y,y.CesiumMath.EPSILON15))throw new g.DeveloperError("Ellipsoid must be an ellipsoid of revolution (radii.x == radii.y)");if(a=P.defaultValue(a,0),t=P.defaultValue(t,0),r=P.defaultValue(r,E.Ellipsoid.WGS84),e.width<=y.CesiumMath.PI){var i=E.Rectangle.center(e,U),s=r.cartographicToCartesian(i,V),o=new b.EllipsoidTangentPlane(s,r),d=o.plane,C=i.longitude,u=e.south<0&&0<e.north?0:i.latitude,c=E.Cartographic.fromRadians(C,e.north,t,k),l=E.Cartographic.fromRadians(e.west,e.north,t,B),h=E.Cartographic.fromRadians(e.west,u,t,_),f=E.Cartographic.fromRadians(e.west,e.south,t,W),m=E.Cartographic.fromRadians(C,e.south,t,X),x=r.cartographicToCartesian(c,j),p=r.cartographicToCartesian(l,Z),M=r.cartographicToCartesian(h,G),w=r.cartographicToCartesian(f,Y),s=r.cartographicToCartesian(m,F),i=o.projectPointToNearestOnPlane(x,H),u=o.projectPointToNearestOnPlane(p,J),C=o.projectPointToNearestOnPlane(M,K),c=o.projectPointToNearestOnPlane(w,Q),h=o.projectPointToNearestOnPlane(s,$),x=-(m=Math.min(u.x,C.x,c.x)),M=Math.max(u.y,i.y),s=Math.min(c.y,h.y);return l.height=f.height=a,p=r.cartographicToCartesian(l,Z),w=r.cartographicToCartesian(f,Y),C=Math.min(N.Plane.getPointDistance(d,p),N.Plane.getPointDistance(d,w)),u=t,q(o.origin,o.xAxis,o.yAxis,o.zAxis,m,x,s,M,C,u,n)}i=0<e.south,c=e.north<0,h=i?e.south:c?e.north:0,l=E.Rectangle.center(e,U).longitude,f=E.Cartesian3.fromRadians(l,h,t,r,ee);f.z=0;p=Math.abs(f.x)<y.CesiumMath.EPSILON10&&Math.abs(f.y)<y.CesiumMath.EPSILON10?E.Cartesian3.UNIT_X:E.Cartesian3.normalize(f,ae),w=E.Cartesian3.UNIT_Z,o=E.Cartesian3.cross(p,w,te);d=N.Plane.fromPointNormal(f,p,de);l=E.Cartesian3.fromRadians(l+y.CesiumMath.PI_OVER_TWO,h,t,r,re);m=-(x=E.Cartesian3.dot(N.Plane.projectPointOntoPlane(d,l,ne),o)),M=E.Cartesian3.fromRadians(0,e.north,c?a:t,r,ie).z,s=E.Cartesian3.fromRadians(0,e.south,i?a:t,r,se).z;r=E.Cartesian3.fromRadians(e.east,h,t,r,oe);return q(f,o,w,p,m,x,s,M,C=N.Plane.getPointDistance(d,r),u=0,n)},v.clone=function(e,a){if(P.defined(e))return P.defined(a)?(E.Cartesian3.clone(e.center,a.center),O.Matrix3.clone(e.halfAxes,a.halfAxes),a):new v(e.center,e.halfAxes)},v.intersectPlane=function(e,a){if(!P.defined(e))throw new g.DeveloperError("box is required.");if(!P.defined(a))throw new g.DeveloperError("plane is required.");var t=e.center,r=a.normal,n=e.halfAxes,i=r.x,s=r.y,e=r.z,n=Math.abs(i*n[O.Matrix3.COLUMN0ROW0]+s*n[O.Matrix3.COLUMN0ROW1]+e*n[O.Matrix3.COLUMN0ROW2])+Math.abs(i*n[O.Matrix3.COLUMN1ROW0]+s*n[O.Matrix3.COLUMN1ROW1]+e*n[O.Matrix3.COLUMN1ROW2])+Math.abs(i*n[O.Matrix3.COLUMN2ROW0]+s*n[O.Matrix3.COLUMN2ROW1]+e*n[O.Matrix3.COLUMN2ROW2]),a=E.Cartesian3.dot(r,t)+a.distance;return a<=-n?O.Intersect.OUTSIDE:n<=a?O.Intersect.INSIDE:O.Intersect.INTERSECTING};var f=new E.Cartesian3,m=new E.Cartesian3,x=new E.Cartesian3,C=new E.Cartesian3;v.distanceSquaredTo=function(e,a){if(!P.defined(e))throw new g.DeveloperError("box is required.");if(!P.defined(a))throw new g.DeveloperError("cartesian is required.");var t=E.Cartesian3.subtract(a,e.center,l),r=e.halfAxes,n=O.Matrix3.getColumn(r,0,f),i=O.Matrix3.getColumn(r,1,m),s=O.Matrix3.getColumn(r,2,x),o=E.Cartesian3.magnitude(n),a=E.Cartesian3.magnitude(i),e=E.Cartesian3.magnitude(s);E.Cartesian3.normalize(n,n),E.Cartesian3.normalize(i,i),E.Cartesian3.normalize(s,s);r=C;r.x=E.Cartesian3.dot(t,n),r.y=E.Cartesian3.dot(t,i),r.z=E.Cartesian3.dot(t,s);var d,s=0;return r.x<-o?s+=(d=r.x+o)*d:r.x>o&&(s+=(d=r.x-o)*d),r.y<-a?s+=(d=r.y+a)*d:r.y>a&&(s+=(d=r.y-a)*d),r.z<-e?s+=(d=r.z+e)*d:r.z>e&&(s+=(d=r.z-e)*d),s};var p=new E.Cartesian3,M=new E.Cartesian3;v.computePlaneDistances=function(e,a,t,r){if(!P.defined(e))throw new g.DeveloperError("box is required.");if(!P.defined(a))throw new g.DeveloperError("position is required.");if(!P.defined(t))throw new g.DeveloperError("direction is required.");P.defined(r)||(r=new O.Interval);var n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,s=e.center,o=e.halfAxes,d=O.Matrix3.getColumn(o,0,f),C=O.Matrix3.getColumn(o,1,m),u=O.Matrix3.getColumn(o,2,x),c=E.Cartesian3.add(d,C,p);E.Cartesian3.add(c,u,c),E.Cartesian3.add(c,s,c);e=E.Cartesian3.subtract(c,a,M),o=E.Cartesian3.dot(t,e),n=Math.min(o,n),i=Math.max(o,i);return E.Cartesian3.add(s,d,c),E.Cartesian3.add(c,C,c),E.Cartesian3.subtract(c,u,c),E.Cartesian3.subtract(c,a,e),o=E.Cartesian3.dot(t,e),n=Math.min(o,n),i=Math.max(o,i),E.Cartesian3.add(s,d,c),E.Cartesian3.subtract(c,C,c),E.Cartesian3.add(c,u,c),E.Cartesian3.subtract(c,a,e),o=E.Cartesian3.dot(t,e),n=Math.min(o,n),i=Math.max(o,i),E.Cartesian3.add(s,d,c),E.Cartesian3.subtract(c,C,c),E.Cartesian3.subtract(c,u,c),E.Cartesian3.subtract(c,a,e),o=E.Cartesian3.dot(t,e),n=Math.min(o,n),i=Math.max(o,i),E.Cartesian3.subtract(s,d,c),E.Cartesian3.add(c,C,c),E.Cartesian3.add(c,u,c),E.Cartesian3.subtract(c,a,e),o=E.Cartesian3.dot(t,e),n=Math.min(o,n),i=Math.max(o,i),E.Cartesian3.subtract(s,d,c),E.Cartesian3.add(c,C,c),E.Cartesian3.subtract(c,u,c),E.Cartesian3.subtract(c,a,e),o=E.Cartesian3.dot(t,e),n=Math.min(o,n),i=Math.max(o,i),E.Cartesian3.subtract(s,d,c),E.Cartesian3.subtract(c,C,c),E.Cartesian3.add(c,u,c),E.Cartesian3.subtract(c,a,e),o=E.Cartesian3.dot(t,e),n=Math.min(o,n),i=Math.max(o,i),E.Cartesian3.subtract(s,d,c),E.Cartesian3.subtract(c,C,c),E.Cartesian3.subtract(c,u,c),E.Cartesian3.subtract(c,a,e),o=E.Cartesian3.dot(t,e),n=Math.min(o,n),i=Math.max(o,i),r.start=n,r.stop=i,r};var t=new O.BoundingSphere;v.isOccluded=function(e,a){if(!P.defined(e))throw new g.DeveloperError("box is required.");if(!P.defined(a))throw new g.DeveloperError("occluder is required.");e=O.BoundingSphere.fromOrientedBoundingBox(e,t);return!a.isBoundingSphereVisible(e)},v.prototype.intersectPlane=function(e){return v.intersectPlane(this,e)},v.prototype.distanceSquaredTo=function(e){return v.distanceSquaredTo(this,e)},v.prototype.computePlaneDistances=function(e,a,t){return v.computePlaneDistances(this,e,a,t)},v.prototype.isOccluded=function(e){return v.isOccluded(this,e)},v.equals=function(e,a){return e===a||P.defined(e)&&P.defined(a)&&E.Cartesian3.equals(e.center,a.center)&&O.Matrix3.equals(e.halfAxes,a.halfAxes)},v.prototype.clone=function(e){return v.clone(this,e)},v.prototype.equals=function(e){return v.equals(this,e)},e.OrientedBoundingBox=v});
//# sourceMappingURL=OrientedBoundingBox-df00886d.js.map
