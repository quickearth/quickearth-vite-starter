{"version":3,"file":"CoplanarPolygonGeometryLibrary-3b5d3c93.js","sources":["../../../../Source/Core/CoplanarPolygonGeometryLibrary.js"],"sourcesContent":["import Cartesian2 from \"./Cartesian2.js\";\nimport Cartesian3 from \"./Cartesian3.js\";\nimport Check from \"./Check.js\";\nimport Matrix3 from \"./Matrix3.js\";\nimport OrientedBoundingBox from \"./OrientedBoundingBox.js\";\n\n/**\n * @private\n */\nvar CoplanarPolygonGeometryLibrary = {};\n\nvar scratchIntersectionPoint = new Cartesian3();\nvar scratchXAxis = new Cartesian3();\nvar scratchYAxis = new Cartesian3();\nvar scratchZAxis = new Cartesian3();\nvar obbScratch = new OrientedBoundingBox();\n\nCoplanarPolygonGeometryLibrary.validOutline = function (positions) {\n  //>>includeStart('debug', pragmas.debug);\n  Check.defined(\"positions\", positions);\n  //>>includeEnd('debug');\n\n  var orientedBoundingBox = OrientedBoundingBox.fromPoints(\n    positions,\n    obbScratch\n  );\n  var halfAxes = orientedBoundingBox.halfAxes;\n  var xAxis = Matrix3.getColumn(halfAxes, 0, scratchXAxis);\n  var yAxis = Matrix3.getColumn(halfAxes, 1, scratchYAxis);\n  var zAxis = Matrix3.getColumn(halfAxes, 2, scratchZAxis);\n\n  var xMag = Cartesian3.magnitude(xAxis);\n  var yMag = Cartesian3.magnitude(yAxis);\n  var zMag = Cartesian3.magnitude(zAxis);\n\n  // If all the points are on a line return undefined because we can't draw a polygon\n  return !(\n    (xMag === 0 && (yMag === 0 || zMag === 0)) ||\n    (yMag === 0 && zMag === 0)\n  );\n};\n\n// call after removeDuplicates\nCoplanarPolygonGeometryLibrary.computeProjectTo2DArguments = function (\n  positions,\n  centerResult,\n  planeAxis1Result,\n  planeAxis2Result\n) {\n  //>>includeStart('debug', pragmas.debug);\n  Check.defined(\"positions\", positions);\n  Check.defined(\"centerResult\", centerResult);\n  Check.defined(\"planeAxis1Result\", planeAxis1Result);\n  Check.defined(\"planeAxis2Result\", planeAxis2Result);\n  //>>includeEnd('debug');\n\n  var orientedBoundingBox = OrientedBoundingBox.fromPoints(\n    positions,\n    obbScratch\n  );\n  var halfAxes = orientedBoundingBox.halfAxes;\n  var xAxis = Matrix3.getColumn(halfAxes, 0, scratchXAxis);\n  var yAxis = Matrix3.getColumn(halfAxes, 1, scratchYAxis);\n  var zAxis = Matrix3.getColumn(halfAxes, 2, scratchZAxis);\n\n  var xMag = Cartesian3.magnitude(xAxis);\n  var yMag = Cartesian3.magnitude(yAxis);\n  var zMag = Cartesian3.magnitude(zAxis);\n  var min = Math.min(xMag, yMag, zMag);\n\n  // If all the points are on a line return undefined because we can't draw a polygon\n  if (\n    (xMag === 0 && (yMag === 0 || zMag === 0)) ||\n    (yMag === 0 && zMag === 0)\n  ) {\n    return false;\n  }\n\n  var planeAxis1;\n  var planeAxis2;\n\n  if (min === yMag || min === zMag) {\n    planeAxis1 = xAxis;\n  }\n  if (min === xMag) {\n    planeAxis1 = yAxis;\n  } else if (min === zMag) {\n    planeAxis2 = yAxis;\n  }\n  if (min === xMag || min === yMag) {\n    planeAxis2 = zAxis;\n  }\n\n  Cartesian3.normalize(planeAxis1, planeAxis1Result);\n  Cartesian3.normalize(planeAxis2, planeAxis2Result);\n  Cartesian3.clone(orientedBoundingBox.center, centerResult);\n  return true;\n};\n\nfunction projectTo2D(position, center, axis1, axis2, result) {\n  var v = Cartesian3.subtract(position, center, scratchIntersectionPoint);\n  var x = Cartesian3.dot(axis1, v);\n  var y = Cartesian3.dot(axis2, v);\n\n  return Cartesian2.fromElements(x, y, result);\n}\n\nCoplanarPolygonGeometryLibrary.createProjectPointsTo2DFunction = function (\n  center,\n  axis1,\n  axis2\n) {\n  return function (positions) {\n    var positionResults = new Array(positions.length);\n    for (var i = 0; i < positions.length; i++) {\n      positionResults[i] = projectTo2D(positions[i], center, axis1, axis2);\n    }\n\n    return positionResults;\n  };\n};\n\nCoplanarPolygonGeometryLibrary.createProjectPointTo2DFunction = function (\n  center,\n  axis1,\n  axis2\n) {\n  return function (position, result) {\n    return projectTo2D(position, center, axis1, axis2, result);\n  };\n};\nexport default CoplanarPolygonGeometryLibrary;\n"],"names":["CoplanarPolygonGeometryLibrary","scratchIntersectionPoint","Cartesian3","scratchXAxis","scratchYAxis","scratchZAxis","obbScratch","OrientedBoundingBox","projectTo2D","position","center","axis1","axis2","result","v","subtract","x","dot","y","Cartesian2","fromElements","validOutline","positions","Check","defined","halfAxes","fromPoints","xAxis","Matrix3","getColumn","yAxis","zAxis","xMag","magnitude","yMag","zMag","computeProjectTo2DArguments","centerResult","planeAxis1Result","planeAxis2Result","planeAxis1","planeAxis2","orientedBoundingBox","min","Math","normalize","clone","createProjectPointsTo2DFunction","positionResults","Array","length","i","createProjectPointTo2DFunction"],"mappings":"4JASIA,EAAiC,GAEjCC,EAA2B,IAAIC,aAC/BC,EAAe,IAAID,aACnBE,EAAe,IAAIF,aACnBG,EAAe,IAAIH,aACnBI,EAAa,IAAIC,sBAoFrB,SAASC,EAAYC,EAAUC,EAAQC,EAAOC,EAAOC,GAC/CC,EAAIZ,aAAWa,SAASN,EAAUC,EAAQT,GAC1Ce,EAAId,aAAWe,IAAIN,EAAOG,GAC1BI,EAAIhB,aAAWe,IAAIL,EAAOE,GAE9B,OAAOK,aAAWC,aAAaJ,EAAGE,EAAGL,GAvFvCb,EAA+BqB,aAAe,SAAUC,GAEtDC,QAAMC,QAAQ,YAAaF,GAG3B,IAIIG,EAJsBlB,sBAAoBmB,WAC5CJ,EACAhB,GAEiCmB,SAC/BE,EAAQC,UAAQC,UAAUJ,EAAU,EAAGtB,GACvC2B,EAAQF,UAAQC,UAAUJ,EAAU,EAAGrB,GACvC2B,EAAQH,UAAQC,UAAUJ,EAAU,EAAGpB,GAEvC2B,EAAO9B,aAAW+B,UAAUN,GAC5BO,EAAOhC,aAAW+B,UAAUH,GAC5BK,EAAOjC,aAAW+B,UAAUF,GAGhC,QACY,IAATC,IAAwB,IAATE,GAAuB,IAATC,IACpB,IAATD,GAAuB,IAATC,IAKnBnC,EAA+BoC,4BAA8B,SAC3Dd,EACAe,EACAC,EACAC,GAGAhB,QAAMC,QAAQ,YAAaF,GAC3BC,QAAMC,QAAQ,eAAgBa,GAC9Bd,QAAMC,QAAQ,mBAAoBc,GAClCf,QAAMC,QAAQ,mBAAoBe,GAGlC,IAsBIC,EACAC,EAvBAC,EAAsBnC,sBAAoBmB,WAC5CJ,EACAhB,GAEEmB,EAAWiB,EAAoBjB,SAC/BE,EAAQC,UAAQC,UAAUJ,EAAU,EAAGtB,GACvC2B,EAAQF,UAAQC,UAAUJ,EAAU,EAAGrB,GACvC2B,EAAQH,UAAQC,UAAUJ,EAAU,EAAGpB,GAEvC2B,EAAO9B,aAAW+B,UAAUN,GAC5BO,EAAOhC,aAAW+B,UAAUH,GAC5BK,EAAOjC,aAAW+B,UAAUF,GAC5BY,EAAMC,KAAKD,IAAIX,EAAME,EAAMC,GAG/B,OACY,IAATH,GAAwB,IAATE,GAAuB,IAATC,KACpB,IAATD,GAAuB,IAATC,KAQbQ,IAAQT,GAAQS,IAAQR,IAC1BK,EAAab,GAEXgB,IAAQX,EACVQ,EAAaV,EACJa,IAAQR,IACjBM,EAAaX,GAEXa,IAAQX,GAAQW,IAAQT,IAC1BO,EAAaV,GAGf7B,aAAW2C,UAAUL,EAAYF,GACjCpC,aAAW2C,UAAUJ,EAAYF,GACjCrC,aAAW4C,MAAMJ,EAAoBhC,OAAQ2B,IACtC,IAWTrC,EAA+B+C,gCAAkC,SAC/DrC,EACAC,EACAC,GAEA,OAAO,SAAUU,GAEf,IADA,IAAI0B,EAAkB,IAAIC,MAAM3B,EAAU4B,QACjCC,EAAI,EAAGA,EAAI7B,EAAU4B,OAAQC,IACpCH,EAAgBG,GAAK3C,EAAYc,EAAU6B,GAAIzC,EAAQC,EAAOC,GAGhE,OAAOoC,IAIXhD,EAA+BoD,+BAAiC,SAC9D1C,EACAC,EACAC,GAEA,OAAO,SAAUH,EAAUI,GACzB,OAAOL,EAAYC,EAAUC,EAAQC,EAAOC,EAAOC"}