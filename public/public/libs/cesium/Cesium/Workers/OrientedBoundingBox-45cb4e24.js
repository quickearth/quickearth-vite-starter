define(["exports","./Transforms-f1816abc","./Cartesian2-716c2715","./Check-d18af7c4","./when-208fe5b0","./EllipsoidTangentPlane-8e486e83","./Math-3ba16bed","./Plane-f5dfabcd"],function(a,O,E,w,P,g,b,y){"use strict";function N(a,e){this.center=E.Cartesian3.clone(P.defaultValue(a,E.Cartesian3.ZERO)),this.halfAxes=O.Matrix3.clone(P.defaultValue(e,O.Matrix3.ZERO))}N.packedLength=E.Cartesian3.packedLength+O.Matrix3.packedLength,N.pack=function(a,e,t){return w.Check.typeOf.object("value",a),w.Check.defined("array",e),t=P.defaultValue(t,0),E.Cartesian3.pack(a.center,e,t),O.Matrix3.pack(a.halfAxes,e,t+E.Cartesian3.packedLength),e},N.unpack=function(a,e,t){return w.Check.defined("array",a),e=P.defaultValue(e,0),P.defined(t)||(t=new N),E.Cartesian3.unpack(a,e,t.center),O.Matrix3.unpack(a,e+E.Cartesian3.packedLength,t.halfAxes),t};var v=new E.Cartesian3,A=new E.Cartesian3,T=new E.Cartesian3,R=new E.Cartesian3,I=new E.Cartesian3,D=new E.Cartesian3,L=new O.Matrix3,z={unitary:new O.Matrix3,diagonal:new O.Matrix3};N.fromPoints=function(a,e){if(P.defined(e)||(e=new N),!P.defined(a)||0===a.length)return e.halfAxes=O.Matrix3.ZERO,e.center=E.Cartesian3.ZERO,e;for(var t=a.length,r=E.Cartesian3.clone(a[0],v),n=1;n<t;n++)E.Cartesian3.add(r,a[n],r);var i=1/t;E.Cartesian3.multiplyByScalar(r,i,r);var s,o=0,d=0,C=0,u=0,c=0,l=0;for(n=0;n<t;n++)o+=(s=E.Cartesian3.subtract(a[n],r,A)).x*s.x,d+=s.x*s.y,C+=s.x*s.z,u+=s.y*s.y,c+=s.y*s.z,l+=s.z*s.z;d*=i,C*=i,u*=i,c*=i,l*=i;var h=L;h[0]=o*=i,h[1]=d,h[2]=C,h[3]=d,h[4]=u,h[5]=c,h[6]=C,h[7]=c,h[8]=l;var h=O.Matrix3.computeEigenDecomposition(h,z),h=O.Matrix3.clone(h.unitary,e.halfAxes),f=O.Matrix3.getColumn(h,0,R),m=O.Matrix3.getColumn(h,1,I),x=O.Matrix3.getColumn(h,2,D),p=-Number.MAX_VALUE,M=-Number.MAX_VALUE,w=-Number.MAX_VALUE,g=Number.MAX_VALUE,b=Number.MAX_VALUE,y=Number.MAX_VALUE;for(n=0;n<t;n++)s=a[n],p=Math.max(E.Cartesian3.dot(f,s),p),M=Math.max(E.Cartesian3.dot(m,s),M),w=Math.max(E.Cartesian3.dot(x,s),w),g=Math.min(E.Cartesian3.dot(f,s),g),b=Math.min(E.Cartesian3.dot(m,s),b),y=Math.min(E.Cartesian3.dot(x,s),y);f=E.Cartesian3.multiplyByScalar(f,.5*(g+p),f),m=E.Cartesian3.multiplyByScalar(m,.5*(b+M),m),x=E.Cartesian3.multiplyByScalar(x,.5*(y+w),x),h=E.Cartesian3.add(f,m,e.center);E.Cartesian3.add(h,x,h);h=T;return h.x=p-g,h.y=M-b,h.z=w-y,E.Cartesian3.multiplyByScalar(h,.5,h),O.Matrix3.multiplyByScale(e.halfAxes,h,e.halfAxes),e};var l=new E.Cartesian3,h=new E.Cartesian3;function S(a,e,t,r,n,i,s,o,d,C,u){if(!(P.defined(n)&&P.defined(i)&&P.defined(s)&&P.defined(o)&&P.defined(d)&&P.defined(C)))throw new w.DeveloperError("all extents (minimum/maximum X/Y/Z) are required.");var c=(u=!P.defined(u)?new N:u).halfAxes;O.Matrix3.setColumn(c,0,e,c),O.Matrix3.setColumn(c,1,t,c),O.Matrix3.setColumn(c,2,r,c),(t=l).x=(n+i)/2,t.y=(s+o)/2,t.z=(d+C)/2;r=h;r.x=(i-n)/2,r.y=(o-s)/2,r.z=(C-d)/2;d=u.center,t=O.Matrix3.multiplyByVector(c,t,t);return E.Cartesian3.add(a,t,d),O.Matrix3.multiplyByScale(c,r,c),u}var q=new E.Cartographic,U=new E.Cartesian3,V=new E.Cartographic,k=new E.Cartographic,B=new E.Cartographic,_=new E.Cartographic,W=new E.Cartographic,X=new E.Cartesian3,j=new E.Cartesian3,Z=new E.Cartesian3,G=new E.Cartesian3,Y=new E.Cartesian3,F=new E.Cartesian2,H=new E.Cartesian2,J=new E.Cartesian2,K=new E.Cartesian2,Q=new E.Cartesian2,$=new E.Cartesian3,aa=new E.Cartesian3,ea=new E.Cartesian3,ta=new E.Cartesian3,ra=new E.Cartesian2,na=new E.Cartesian3,ia=new E.Cartesian3,sa=new E.Cartesian3,oa=new y.Plane(E.Cartesian3.UNIT_X,0);N.fromRectangle=function(a,e,t,r,n){if(!P.defined(a))throw new w.DeveloperError("rectangle is required");if(a.width<0||a.width>b.CesiumMath.TWO_PI)throw new w.DeveloperError("Rectangle width must be between 0 and 2*pi");if(a.height<0||a.height>b.CesiumMath.PI)throw new w.DeveloperError("Rectangle height must be between 0 and pi");if(P.defined(r)&&!b.CesiumMath.equalsEpsilon(r.radii.x,r.radii.y,b.CesiumMath.EPSILON15))throw new w.DeveloperError("Ellipsoid must be an ellipsoid of revolution (radii.x == radii.y)");if(e=P.defaultValue(e,0),t=P.defaultValue(t,0),r=P.defaultValue(r,E.Ellipsoid.WGS84),a.width<=b.CesiumMath.PI){var i=E.Rectangle.center(a,q),s=r.cartographicToCartesian(i,U),o=new g.EllipsoidTangentPlane(s,r),d=o.plane,C=i.longitude,u=a.south<0&&0<a.north?0:i.latitude,c=E.Cartographic.fromRadians(C,a.north,t,V),l=E.Cartographic.fromRadians(a.west,a.north,t,k),h=E.Cartographic.fromRadians(a.west,u,t,B),f=E.Cartographic.fromRadians(a.west,a.south,t,_),m=E.Cartographic.fromRadians(C,a.south,t,W),x=r.cartographicToCartesian(c,X),p=r.cartographicToCartesian(l,j),M=r.cartographicToCartesian(h,Z),s=r.cartographicToCartesian(f,G),i=r.cartographicToCartesian(m,Y),u=o.projectPointToNearestOnPlane(x,F),C=o.projectPointToNearestOnPlane(p,H),c=o.projectPointToNearestOnPlane(M,J),h=o.projectPointToNearestOnPlane(s,K),m=o.projectPointToNearestOnPlane(i,Q),M=-(x=Math.min(C.x,c.x,h.x)),i=Math.max(C.y,u.y),c=Math.min(h.y,m.y);return l.height=f.height=e,p=r.cartographicToCartesian(l,j),s=r.cartographicToCartesian(f,G),C=Math.min(y.Plane.getPointDistance(d,p),y.Plane.getPointDistance(d,s)),S(o.origin,o.xAxis,o.yAxis,o.zAxis,x,M,c,i,C,t,n)}u=0<a.south,h=a.north<0,m=u?a.south:h?a.north:0,l=E.Rectangle.center(a,q).longitude,f=E.Cartesian3.fromRadians(l,m,t,r,$);f.z=0;p=Math.abs(f.x)<b.CesiumMath.EPSILON10&&Math.abs(f.y)<b.CesiumMath.EPSILON10?E.Cartesian3.UNIT_X:E.Cartesian3.normalize(f,aa),s=E.Cartesian3.UNIT_Z,o=E.Cartesian3.cross(p,s,ea);d=y.Plane.fromPointNormal(f,p,oa);l=E.Cartesian3.fromRadians(l+b.CesiumMath.PI_OVER_TWO,m,t,r,ta);x=-(M=E.Cartesian3.dot(y.Plane.projectPointOntoPlane(d,l,ra),o)),i=E.Cartesian3.fromRadians(0,a.north,h?e:t,r,na).z,c=E.Cartesian3.fromRadians(0,a.south,u?e:t,r,ia).z;r=E.Cartesian3.fromRadians(a.east,m,t,r,sa);return S(f,o,s,p,x,M,c,i,C=y.Plane.getPointDistance(d,r),0,n)},N.clone=function(a,e){if(P.defined(a))return P.defined(e)?(E.Cartesian3.clone(a.center,e.center),O.Matrix3.clone(a.halfAxes,e.halfAxes),e):new N(a.center,a.halfAxes)},N.intersectPlane=function(a,e){if(!P.defined(a))throw new w.DeveloperError("box is required.");if(!P.defined(e))throw new w.DeveloperError("plane is required.");var t=a.center,r=e.normal,n=a.halfAxes,i=r.x,s=r.y,a=r.z,n=Math.abs(i*n[O.Matrix3.COLUMN0ROW0]+s*n[O.Matrix3.COLUMN0ROW1]+a*n[O.Matrix3.COLUMN0ROW2])+Math.abs(i*n[O.Matrix3.COLUMN1ROW0]+s*n[O.Matrix3.COLUMN1ROW1]+a*n[O.Matrix3.COLUMN1ROW2])+Math.abs(i*n[O.Matrix3.COLUMN2ROW0]+s*n[O.Matrix3.COLUMN2ROW1]+a*n[O.Matrix3.COLUMN2ROW2]),e=E.Cartesian3.dot(r,t)+e.distance;return e<=-n?O.Intersect.OUTSIDE:n<=e?O.Intersect.INSIDE:O.Intersect.INTERSECTING};var f=new E.Cartesian3,m=new E.Cartesian3,x=new E.Cartesian3,C=new E.Cartesian3;N.distanceSquaredTo=function(a,e){if(!P.defined(a))throw new w.DeveloperError("box is required.");if(!P.defined(e))throw new w.DeveloperError("cartesian is required.");var t=E.Cartesian3.subtract(e,a.center,l),r=a.halfAxes,n=O.Matrix3.getColumn(r,0,f),i=O.Matrix3.getColumn(r,1,m),s=O.Matrix3.getColumn(r,2,x),o=E.Cartesian3.magnitude(n),e=E.Cartesian3.magnitude(i),a=E.Cartesian3.magnitude(s);E.Cartesian3.normalize(n,n),E.Cartesian3.normalize(i,i),E.Cartesian3.normalize(s,s);r=C;r.x=E.Cartesian3.dot(t,n),r.y=E.Cartesian3.dot(t,i),r.z=E.Cartesian3.dot(t,s);var d,s=0;return r.x<-o?s+=(d=r.x+o)*d:r.x>o&&(s+=(d=r.x-o)*d),r.y<-e?s+=(d=r.y+e)*d:r.y>e&&(s+=(d=r.y-e)*d),r.z<-a?s+=(d=r.z+a)*d:r.z>a&&(s+=(d=r.z-a)*d),s};var p=new E.Cartesian3,M=new E.Cartesian3;N.computePlaneDistances=function(a,e,t,r){if(!P.defined(a))throw new w.DeveloperError("box is required.");if(!P.defined(e))throw new w.DeveloperError("position is required.");if(!P.defined(t))throw new w.DeveloperError("direction is required.");P.defined(r)||(r=new O.Interval);var n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,s=a.center,o=a.halfAxes,d=O.Matrix3.getColumn(o,0,f),C=O.Matrix3.getColumn(o,1,m),u=O.Matrix3.getColumn(o,2,x),c=E.Cartesian3.add(d,C,p);E.Cartesian3.add(c,u,c),E.Cartesian3.add(c,s,c);a=E.Cartesian3.subtract(c,e,M),o=E.Cartesian3.dot(t,a),n=Math.min(o,n),i=Math.max(o,i);return E.Cartesian3.add(s,d,c),E.Cartesian3.add(c,C,c),E.Cartesian3.subtract(c,u,c),E.Cartesian3.subtract(c,e,a),o=E.Cartesian3.dot(t,a),n=Math.min(o,n),i=Math.max(o,i),E.Cartesian3.add(s,d,c),E.Cartesian3.subtract(c,C,c),E.Cartesian3.add(c,u,c),E.Cartesian3.subtract(c,e,a),o=E.Cartesian3.dot(t,a),n=Math.min(o,n),i=Math.max(o,i),E.Cartesian3.add(s,d,c),E.Cartesian3.subtract(c,C,c),E.Cartesian3.subtract(c,u,c),E.Cartesian3.subtract(c,e,a),o=E.Cartesian3.dot(t,a),n=Math.min(o,n),i=Math.max(o,i),E.Cartesian3.subtract(s,d,c),E.Cartesian3.add(c,C,c),E.Cartesian3.add(c,u,c),E.Cartesian3.subtract(c,e,a),o=E.Cartesian3.dot(t,a),n=Math.min(o,n),i=Math.max(o,i),E.Cartesian3.subtract(s,d,c),E.Cartesian3.add(c,C,c),E.Cartesian3.subtract(c,u,c),E.Cartesian3.subtract(c,e,a),o=E.Cartesian3.dot(t,a),n=Math.min(o,n),i=Math.max(o,i),E.Cartesian3.subtract(s,d,c),E.Cartesian3.subtract(c,C,c),E.Cartesian3.add(c,u,c),E.Cartesian3.subtract(c,e,a),o=E.Cartesian3.dot(t,a),n=Math.min(o,n),i=Math.max(o,i),E.Cartesian3.subtract(s,d,c),E.Cartesian3.subtract(c,C,c),E.Cartesian3.subtract(c,u,c),E.Cartesian3.subtract(c,e,a),o=E.Cartesian3.dot(t,a),n=Math.min(o,n),i=Math.max(o,i),r.start=n,r.stop=i,r};var t=new O.BoundingSphere;N.isOccluded=function(a,e){if(!P.defined(a))throw new w.DeveloperError("box is required.");if(!P.defined(e))throw new w.DeveloperError("occluder is required.");a=O.BoundingSphere.fromOrientedBoundingBox(a,t);return!e.isBoundingSphereVisible(a)},N.prototype.intersectPlane=function(a){return N.intersectPlane(this,a)},N.prototype.distanceSquaredTo=function(a){return N.distanceSquaredTo(this,a)},N.prototype.computePlaneDistances=function(a,e,t){return N.computePlaneDistances(this,a,e,t)},N.prototype.isOccluded=function(a){return N.isOccluded(this,a)},N.equals=function(a,e){return a===e||P.defined(a)&&P.defined(e)&&E.Cartesian3.equals(a.center,e.center)&&O.Matrix3.equals(a.halfAxes,e.halfAxes)},N.prototype.clone=function(a){return N.clone(this,a)},N.prototype.equals=function(a){return N.equals(this,a)},a.OrientedBoundingBox=N});
//# sourceMappingURL=OrientedBoundingBox-45cb4e24.js.map
